<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Don&#39;t starve Together server 使用Linux Shell脚本管理DST饥荒服务器</title>
      <link href="2018/02/20/dst-shell/"/>
      <url>2018/02/20/dst-shell/</url>
      
        <content type="html"><![CDATA[<h2 id="DST饥荒游戏服务器搭建脚本"><a href="#DST饥荒游戏服务器搭建脚本" class="headerlink" title="DST饥荒游戏服务器搭建脚本"></a>DST饥荒游戏服务器搭建脚本</h2><p>上一次写了个饥荒服务器的搭建教程，后来想想一系列命令行操作有些繁琐，于是乎就想着把这些初始的游戏server安装配置自动化构建起来,那么什么最适合简单的服务器自动化命令操作呢？<br>在Linux服务器上这个答案显然是Shell脚本,(因为功能很少很简单还用不到python 233)<br>对于大家来说当然越简单使用当然越好，这样想了想, 然后就写了个小脚本:</p><blockquote><p>go.sh</p></blockquote><p>这个思想很简单，就是将更新服务器源到获取steamcmd到安装dst server版，建立文件夹等操作串联起来:</p><a id="more"></a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install lib32gcc1 libcurl4-gnutls-dev:i386 screen</span><br><span class="line"></span><br><span class="line">mkdir ~/steamcmd</span><br><span class="line"><span class="built_in">cd</span> ~/steamcmd</span><br><span class="line"></span><br><span class="line">wget https://steamcdn-a.akamaihd.net/client/installer/steamcmd_linux.tar.gz</span><br><span class="line">tar -xvzf steamcmd_linux.tar.gz</span><br><span class="line">./steamcmd.sh +login anonymous +force_install_dir ~/dst +app_update 343050 validate +quit</span><br><span class="line"></span><br><span class="line">cp ~/steamcmd/linux32/libstdc++.so.6 ~/dst/bin/lib32/</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> ~/dst/bin</span><br><span class="line"><span class="built_in">echo</span> ./dontstarve_dedicated_server_nullrenderer -console -cluster MyDediServer -shard Master &gt; overworld.sh</span><br><span class="line"><span class="built_in">echo</span> ./dontstarve_dedicated_server_nullrenderer -console -cluster MyDediServer -shard Caves &gt; cave.sh</span><br><span class="line"></span><br><span class="line">mkdir -p ~/.klei/DoNotStarveTogether/MyDediServer</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> ~</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ `<span class="built_in">echo</span> $?` -eq 0 ]]; <span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[42;30m ### 游戏服务器初始化完成,请放入配置文件并执行 ./dst \033[0m&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[31m 执行出现了错误，可能因为网络不好，请尝试重新执行一次 \033[0m&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="用法-source-go-sh"><a href="#用法-source-go-sh" class="headerlink" title="用法: source go.sh"></a>用法: source go.sh</h4><hr><h2 id="DST饥荒游戏服务器管理脚本"><a href="#DST饥荒游戏服务器管理脚本" class="headerlink" title="DST饥荒游戏服务器管理脚本"></a>DST饥荒游戏服务器管理脚本</h2><p>随着游戏内时间的增加，饥荒服务器往往要经常更新，这个时候总是要登陆服务器运行一大串命令，就显得很是麻烦，于是我就搞了个简单管理脚本</p><blockquote><p>dst.sh</p></blockquote><p>主要原理就是将管理功能分解，比如启动服务，停止进程，重启，删除游戏记录文件，更新服务器等等..<br>一次输入交互，然后选择不同目标函数执行即可.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">master=<span class="string">&#x27;.klei/DoNotStarveTogether/MyDediServer/Master/&#x27;</span></span><br><span class="line">cave=<span class="string">&#x27;.klei/DoNotStarveTogether/MyDediServer/Caves/&#x27;</span></span><br><span class="line"></span><br><span class="line">dst_dir=(<span class="variable">$&#123;master&#125;</span> <span class="variable">$&#123;cave&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">stop</span></span>()&#123;</span><br><span class="line">ps -ef|grep dontstarve|awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>|xargs <span class="built_in">kill</span> -9</span><br><span class="line"><span class="keyword">if</span> [[ -z `ps -ef | grep -v grep |grep -v <span class="string">&quot;dst.sh&quot;</span>|grep <span class="string">&quot;dontstarve&quot;</span>|sed -n <span class="string">&#x27;1P&#x27;</span>|awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>` ]]; <span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m ##: 饥荒服务器停止成功!! \033[0m&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">del</span></span>()&#123;</span><br><span class="line">stop</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="variable">$&#123;dst_dir[@]&#125;</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="keyword">if</span> [[ -d <span class="variable">$&#123;i&#125;</span><span class="string">&quot;save&quot;</span> ]]; <span class="keyword">then</span></span><br><span class="line">rm -r <span class="variable">$&#123;i&#125;</span><span class="string">&quot;save&quot;</span>&amp;&amp;rm -r `find <span class="variable">$&#123;i&#125;</span> -name <span class="string">&quot;*.txt&quot;</span>` &amp;&amp; rm -r <span class="variable">$&#123;i&#125;</span><span class="string">&quot;backup&quot;</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m ##: <span class="variable">$&#123;i&#125;</span>&#x27;s 文件已经删除! \033[0m&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">goMaster</span></span>()&#123;</span><br><span class="line"><span class="built_in">cd</span> ~/dst/bin</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ -z `ps -ef | grep -v grep |grep -v <span class="string">&quot;dst.sh&quot;</span>|grep <span class="string">&quot;Master&quot;</span>|sed -n <span class="string">&#x27;1P&#x27;</span>|awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>` ]]; <span class="keyword">then</span></span><br><span class="line">screen -dm sh overworld.sh &amp;&amp; <span class="keyword">if</span> [[ `<span class="built_in">echo</span> $?` -eq 0 ]]; </span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[36m ##: 地上成功启动... \033[0m&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[31m !!! 地上正在运行中!!! \033[0m&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">goCaves</span></span>()&#123;</span><br><span class="line"><span class="built_in">cd</span> ~/dst/bin</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ -z `ps -ef | grep -v grep |grep -v <span class="string">&quot;dst.sh&quot;</span>|grep <span class="string">&quot;Caves&quot;</span>|sed -n <span class="string">&#x27;1P&#x27;</span>|awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>` ]]; <span class="keyword">then</span></span><br><span class="line">screen -dm sh cave.sh &amp;&amp; <span class="keyword">if</span> [[ `<span class="built_in">echo</span> $?` -eq 0 ]]; <span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[36m ##: 洞穴启动成功... \033[0m&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[31m !!!洞穴正在运行中!!! \033[0m&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">go</span></span>()&#123;</span><br><span class="line">goMaster</span><br><span class="line">goCaves</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">restart</span></span>()&#123;</span><br><span class="line">stop</span><br><span class="line">go</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">reset</span></span>()&#123;</span><br><span class="line">del</span><br><span class="line">go</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">updst</span></span>()&#123;</span><br><span class="line">stop</span><br><span class="line">~/steamcmd/steamcmd.sh +login anonymous +force_install_dir ~/dst +app_update 343050 validate +quit</span><br><span class="line"><span class="keyword">if</span> [[ `<span class="built_in">echo</span> $?` -eq 0 ]]; <span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[46;37m ##: 饥荒游戏版本更新成功!! \033[0m&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">main</span></span>()&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[42;30m ### 饥荒Sever管理脚本 ### \033[0m&quot;</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m 0. \033[0m 启动地上+洞穴&quot;</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m 1. \033[0m 只启动地上&quot;</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m 2. \033[0m 只启动洞穴&quot;</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m 3. \033[0m 停止饥荒游戏进程&quot;</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m 4. \033[0m 删除游戏存档记录&quot;</span>                                                                                             </span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m 5. \033[0m 重启游戏(非重置),可以更新mod&quot;</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m 6. \033[0m 重置饥荒游戏,将删除游戏存档记录&quot;</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[32m 7. \033[0m 更新饥荒游戏版本&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;输入数字,回车确认选择: &quot;</span> choose</span><br><span class="line"><span class="keyword">case</span> <span class="variable">$choose</span> <span class="keyword">in</span></span><br><span class="line">0 ) go</span><br><span class="line">;;</span><br><span class="line">1 ) goMaster</span><br><span class="line">;;</span><br><span class="line">2 ) goCaves</span><br><span class="line">;;</span><br><span class="line">3 ) stop</span><br><span class="line">;;</span><br><span class="line">4 ) del</span><br><span class="line">;;</span><br><span class="line">5 ) restart</span><br><span class="line">;;</span><br><span class="line">6 ) reset</span><br><span class="line">;;</span><br><span class="line">7 ) updst</span><br><span class="line">;;</span><br><span class="line">* ) <span class="built_in">echo</span> -e <span class="string">&quot;\033[31m 请输入下列正确的数字选项!! \033[0m&quot;</span></span><br><span class="line">main</span><br><span class="line">;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="用法：-dst-sh"><a href="#用法：-dst-sh" class="headerlink" title="用法： ./dst.sh"></a>用法： ./dst.sh</h4><h5 id="这样日常再维护游戏服务器就很方便啦"><a href="#这样日常再维护游戏服务器就很方便啦" class="headerlink" title="这样日常再维护游戏服务器就很方便啦~"></a>这样日常再维护游戏服务器就很方便啦~</h5><p>详情见:—&gt;<a href="https://github.com/qwertyuiop6/DST-Server-Build">DST-Server-Build</a></p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Game </tag>
            
            <tag> Linux </tag>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Don&#39;t starve Together server 饥荒服务器搭建</title>
      <link href="2018/01/12/my-first-article/"/>
      <url>2018/01/12/my-first-article/</url>
      
        <content type="html"><![CDATA[<h2 id="Don’t-Starve-Together服务器搭建-Linux"><a href="#Don’t-Starve-Together服务器搭建-Linux" class="headerlink" title="Don’t Starve Together服务器搭建(Linux)"></a>Don’t Starve Together服务器搭建(Linux)</h2><blockquote><p>本教程旨在为了解linux的玩家提供简易搭建教程。VPS-OS：ubuntu64</p></blockquote><p>Klei官方英文搭建教程地址:<a href="http://dont-starve-game.wikia.com/wiki/Guides/Don%E2%80%99t_Starve_Together_Dedicated_Servers">Don’t Strave Together Dedicated Server</a></p><img src="/2018/01/12/my-first-article/dst.png" class="" title="Don’t Starve Together"><a id="more"></a><h4 id="1-配置服务器运行环境"><a href="#1-配置服务器运行环境" class="headerlink" title="1.配置服务器运行环境"></a>1.配置服务器运行环境</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update  <span class="comment">#更新源</span></span><br><span class="line">sudo apt-get install lib32gcc1 libcurl4-gnutls-dev:i386 screen <span class="comment">#必要的库和软件</span></span><br></pre></td></tr></table></figure><h4 id="2-安装steanm命令行平台和游戏包"><a href="#2-安装steanm命令行平台和游戏包" class="headerlink" title="2.安装steanm命令行平台和游戏包"></a>2.安装steanm命令行平台和游戏包</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir ~/steamcmd   <span class="comment">#创建文件夹</span></span><br><span class="line"><span class="built_in">cd</span> ~/steamcmd   <span class="comment">#打开文件夹</span></span><br><span class="line">wget https://steamcdn-a.akamaihd.net/client/installer/steamcmd_linux.tar.gz   <span class="comment">#下载精简包</span></span><br><span class="line">tar -xvzf steamcmd_linux.tar.gz   <span class="comment">#解压包</span></span><br><span class="line">./steamcmd.sh +login anonymous +force_install_dir ~/dst +app_update 343050 validate +quit    <span class="comment">#匿名登录steamcmd，安装饥荒(DST)到~/dst</span></span><br></pre></td></tr></table></figure><h4 id="3-测试运行环境"><a href="#3-测试运行环境" class="headerlink" title="3.测试运行环境"></a>3.测试运行环境</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/dst/bin   <span class="comment">#打开启动命令文件夹</span></span><br><span class="line">./dontstarve_dedicated_server_nullrenderer   <span class="comment">#运行测试是否有错误</span></span><br></pre></td></tr></table></figure><div class="note danger flat"><h6 id="一般会有下面这个错误出现："><a href="#一般会有下面这个错误出现：" class="headerlink" title="一般会有下面这个错误出现："></a>一般会有下面这个错误出现：</h6><p>libstdc++.so.6: version GLIBCXX_3.4.15 not found</p></div><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp ~/steamcmd/linux32/libstdc++.so.6 ~/dst/bin/lib32/   <span class="comment">#这是因为缺少库文件,输入此命令复制库文件解决</span></span><br></pre></td></tr></table></figure><hr><h4 id="4-运行启动文件"><a href="#4-运行启动文件" class="headerlink" title="4.运行启动文件"></a>4.运行启动文件</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/dst/bin/</span><br><span class="line"><span class="built_in">echo</span> ./dontstarve_dedicated_server_nullrenderer -console -cluster MyDediServer -shard Master &gt; overworld.sh   <span class="comment">#地上世界启动脚本</span></span><br><span class="line"><span class="built_in">echo</span> ./dontstarve_dedicated_server_nullrenderer -console -cluster MyDediServer -shard Caves &gt; cave.sh   <span class="comment">#洞穴启动脚本</span></span><br><span class="line">sh overworld.sh   <span class="comment">#运行，等待几秒会提示你Your Server Will Not Start，这时按Ctrl+c终止进程</span></span><br><span class="line">sh cave.sh   <span class="comment">#运行，等待几秒会提示你Your Server Will Not Start，这时按Ctrl+c终止进程</span></span><br><span class="line">rm -rf ~/.klei/DoNotStarveTogether/Cluster_*   <span class="comment">#删除默认文件</span></span><br></pre></td></tr></table></figure><div class="note success flat"><p>~/.klei/DoNotStarveTogether/MyDediServer  是默认配置目录，里面两个Master和caves分别是地上和洞穴配置目录</p></div><h4 id="5-配置核心文件"><a href="#5-配置核心文件" class="headerlink" title="5.配置核心文件"></a>5.配置核心文件</h4><blockquote><p>1.配置cluster_token.txt文件</p></blockquote><p>进入饥荒主页面，右下角点击Account图标，在打开的页面找到Generate Server Token 按钮，随便输入一个描述，会生成一个token,新建一个cluster_token.txt文件，复制进去，放在MyDediServer目录下。</p><blockquote><p>2.通用配置文件cluster.ini</p></blockquote><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[MISC]</span></span><br><span class="line"><span class="attr">max_snapshots</span> = <span class="number">6</span>                  <span class="comment"># 最大快照数，决定了可回滚的天数</span></span><br><span class="line"><span class="attr">console_enabled</span> = <span class="literal">true</span>             <span class="comment"># 是否开启控制台</span></span><br><span class="line"> </span><br><span class="line"><span class="section">[SHARD]</span></span><br><span class="line"><span class="attr">shard_enabled</span> = <span class="literal">true</span>               <span class="comment"># 服务器共享，要开启洞穴服务器的必须启用</span></span><br><span class="line"><span class="attr">bind_ip</span> = <span class="number">127.0</span>.<span class="number">0.1</span>                <span class="comment"># 服务器监听的地址，当所有实例都运行在同一台机器时，可填写 127.0.0.1，会被 server .ini 覆盖</span></span><br><span class="line"><span class="attr">master_ip</span> = <span class="number">127.0</span>.<span class="number">0.1</span>              <span class="comment"># master 服务器的 IP，针对非 master 服务器，若与 master 服务器运行在同一台机器时，可填写 127.0.0.1，会被 server.ini 覆盖</span></span><br><span class="line"><span class="attr">master_port</span> = <span class="number">10888</span>                <span class="comment"># 监听 master 服务器的 UDP 端口，所有连接至 master 服务器的非 master 服务器必须相同</span></span><br><span class="line"><span class="attr">cluster_key</span> = dst                  <span class="comment"># 连接密码，每台服务器必须相同，会被 server.ini 覆盖</span></span><br><span class="line"> </span><br><span class="line"><span class="section">[STEAM]</span></span><br><span class="line"><span class="attr">steam_group_only</span> = <span class="literal">false</span>           <span class="comment"># 只允许某 Steam 组的成员加入</span></span><br><span class="line"><span class="attr">steam_group_id</span> = <span class="number">0</span>                 <span class="comment"># 指定某个 Steam 组，填写组 ID</span></span><br><span class="line"><span class="attr">steam_group_admins</span> = <span class="literal">false</span>         <span class="comment"># 开启后，Steam 组的管理员拥有服务器的管理权限</span></span><br><span class="line"> </span><br><span class="line"><span class="section">[NETWORK]</span></span><br><span class="line"><span class="attr">offline_server</span> = <span class="literal">false</span>             <span class="comment"># 离线服务器，只有局域网用户能加入，并且所有依赖于 Steam 的任何功能都无效，比如说饰品掉落</span></span><br><span class="line"><span class="attr">tick_rate</span> = <span class="number">15</span>                     <span class="comment"># 每秒通信次数，越高游戏体验越好，但是会加大服务器负担</span></span><br><span class="line"><span class="attr">whitelist_slots</span> = <span class="number">0</span>                <span class="comment"># 为白名单用户保留的游戏位</span></span><br><span class="line">cluster_password =                 # 游戏密码，不设置表示无密码</span><br><span class="line"><span class="attr">cluster_name</span> = ttionya test        <span class="comment"># 游戏房间名称</span></span><br><span class="line"><span class="attr">cluster_description</span> = description  <span class="comment"># 游戏房间描述</span></span><br><span class="line"><span class="attr">lan_only_cluster</span> = <span class="literal">false</span>           <span class="comment"># 局域网游戏</span></span><br><span class="line"><span class="attr">cluster_intention</span> = madness        <span class="comment"># 游戏偏好，选项为 cooperative, competitive, social, or madness，没什么用</span></span><br><span class="line"> </span><br><span class="line"><span class="section">[GAMEPLAY]</span></span><br><span class="line"><span class="attr">max_players</span> = <span class="number">16</span>                   <span class="comment"># 最大游戏人数</span></span><br><span class="line"><span class="attr">pvp</span> = <span class="literal">false</span>                         <span class="comment"># 能不能攻击其他玩家</span></span><br><span class="line"><span class="attr">game_mode</span> = survival               <span class="comment"># 游戏模式，可选 survival, endless or wilderness</span></span><br><span class="line"><span class="attr">pause_when_empty</span> = <span class="literal">true</span>           <span class="comment"># 没人服务器暂停</span></span><br><span class="line"><span class="attr">vote_kick_enabled</span> = <span class="literal">true</span>          <span class="comment"># 投票踢人</span></span><br></pre></td></tr></table></figure><p>设置完毕保存为cluster.ini文件,放在MyDediServer下。</p><blockquote><p>3.地上和洞穴独立配置文件server.ini</p></blockquote><p>配置介绍：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[SHARD]</span></span><br><span class="line"><span class="attr">is_master</span> = <span class="literal">true</span> /<span class="literal">false</span>      <span class="comment"># 是否是 master 服务器，只能存在一个 true，其他全是 false</span></span><br><span class="line"><span class="attr">name</span> = caves                 <span class="comment"># 针对非 master 服务器的名称</span></span><br><span class="line"> </span><br><span class="line"><span class="section">[STEAM]</span></span><br><span class="line"><span class="attr">authentication_port</span> = <span class="number">8766</span>   <span class="comment"># Steam 用的端口，确保每个实例都不相同</span></span><br><span class="line"><span class="attr">master_server_port</span> = <span class="number">27016</span>   <span class="comment"># Steam 用的端口，确保每个实例都不相同</span></span><br><span class="line"> </span><br><span class="line"><span class="section">[NETWORK]</span></span><br><span class="line"><span class="attr">server_port</span> = <span class="number">10999</span>          <span class="comment"># 监听的 UDP 端口，只能介于 10998 - 11018 之间，确保每个实例都不相同</span></span><br></pre></td></tr></table></figure><p>地上和洞穴配置具体在下方：<br>（地上）Master文件夹里的server.ini：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[SHARD]</span></span><br><span class="line"><span class="attr">is_master</span> = <span class="literal">true</span></span><br><span class="line"> </span><br><span class="line"><span class="section">[STEAM]</span></span><br><span class="line"><span class="attr">authentication_port</span> = <span class="number">12345</span></span><br><span class="line"><span class="attr">master_server_port</span> = <span class="number">12346</span></span><br><span class="line"> </span><br><span class="line"><span class="section">[NETWORK]</span></span><br><span class="line"><span class="attr">server_port</span> = <span class="number">10999</span></span><br></pre></td></tr></table></figure><p>(洞穴)Caves文件夹里的server.ini:</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[SHARD]</span></span><br><span class="line"><span class="attr">is_master</span> = <span class="literal">false</span></span><br><span class="line"><span class="attr">name</span> = caves</span><br><span class="line"> </span><br><span class="line"><span class="section">[STEAM]</span></span><br><span class="line"><span class="attr">authentication_port</span> = <span class="number">12347</span></span><br><span class="line"><span class="attr">master_server_port</span> = <span class="number">12348</span></span><br><span class="line"> </span><br><span class="line"><span class="section">[NETWORK]</span></span><br><span class="line"><span class="attr">server_port</span> = <span class="number">11000</span></span><br></pre></td></tr></table></figure><blockquote><p>4.地上和洞穴的地图配置文件worldgenoverride.lua</p></blockquote><p>地上：</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">    override_enabled = <span class="literal">true</span>,</span><br><span class="line">    preset = <span class="string">&quot;SURVIVAL_TOGETHER&quot;</span>,       <span class="comment">-- &quot;SURVIVAL_TOGETHER&quot;, &quot;MOD_MISSING&quot;, &quot;SURVIVAL_TOGETHER_CLASSIC&quot;, &quot;SURVIVAL_DEFAULT_PLUS&quot;, &quot;COMPLETE_DARKNESS&quot;, &quot;DST_CAVE&quot;, &quot;DST_CAVE_PLUS&quot;</span></span><br><span class="line">    overrides = &#123;</span><br><span class="line">        <span class="comment">-- default is &quot;never&quot;, &quot;rare&quot;, &quot;default&quot;, &quot;often&quot;, &quot;always&quot; 下方值为default的几个调节的选项，从不，很少，默认，经常，总是</span></span><br><span class="line">  </span><br><span class="line">        <span class="comment">-- MISC</span></span><br><span class="line">        task_set = <span class="string">&quot;default&quot;</span>,           <span class="comment">-- &quot;classic&quot;, &quot;default&quot;, &quot;cave_default&quot;</span></span><br><span class="line">        start_location = <span class="string">&quot;default&quot;</span>,     <span class="comment">-- &quot;caves&quot;, &quot;default&quot;, &quot;plus&quot;, &quot;darkness&quot;</span></span><br><span class="line">        world_size = <span class="string">&quot;default&quot;</span>,         <span class="comment">-- &quot;small&quot;, &quot;medium&quot;, &quot;default&quot;, &quot;huge&quot;-世界大小</span></span><br><span class="line">        branching = <span class="string">&quot;default&quot;</span>,          <span class="comment">-- &quot;never&quot;, &quot;least&quot;, &quot;default&quot;, &quot;most&quot; </span></span><br><span class="line">        loop = <span class="string">&quot;default&quot;</span>,               <span class="comment">-- &quot;never&quot;, &quot;default&quot;, &quot;always&quot;</span></span><br><span class="line">        autumn = <span class="string">&quot;default&quot;</span>,             <span class="comment">-- &quot;noseason&quot;, &quot;veryshortseason&quot;, &quot;shortseason&quot;, &quot;default&quot;, &quot;longseason&quot;, &quot;verylongseason&quot;, &quot;random&quot;</span></span><br><span class="line">        winter = <span class="string">&quot;default&quot;</span>,             <span class="comment">-- &quot;noseason&quot;, &quot;veryshortseason&quot;, &quot;shortseason&quot;, &quot;default&quot;, &quot;longseason&quot;, &quot;verylongseason&quot;, &quot;random&quot;</span></span><br><span class="line">        spring = <span class="string">&quot;default&quot;</span>,             <span class="comment">-- &quot;noseason&quot;, &quot;veryshortseason&quot;, &quot;shortseason&quot;, &quot;default&quot;, &quot;longseason&quot;, &quot;verylongseason&quot;, &quot;random&quot;</span></span><br><span class="line">        summer = <span class="string">&quot;default&quot;</span>,             <span class="comment">-- &quot;noseason&quot;, &quot;veryshortseason&quot;, &quot;shortseason&quot;, &quot;default&quot;, &quot;longseason&quot;, &quot;verylongseason&quot;, &quot;random&quot;</span></span><br><span class="line">        season_start = <span class="string">&quot;default&quot;</span>,       <span class="comment">-- &quot;default&quot;, &quot;winter&quot;, &quot;spring&quot;, &quot;summer&quot;, &quot;autumnorspring&quot;, &quot;winterorsummer&quot;, &quot;random&quot;</span></span><br><span class="line">        day = <span class="string">&quot;default&quot;</span>,                <span class="comment">-- &quot;default&quot;, &quot;longday&quot;, &quot;longdusk&quot;, &quot;longnight&quot;, &quot;noday&quot;, &quot;nodusk&quot;, &quot;nonight&quot;, &quot;onlyday&quot;, &quot;onlydusk&quot;, &quot;onlynight&quot;</span></span><br><span class="line">        weather = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        earthquakes = <span class="string">&quot;default&quot;</span>, <span class="comment">--地震</span></span><br><span class="line">        lightning = <span class="string">&quot;default&quot;</span>, </span><br><span class="line">        frograin = <span class="string">&quot;default&quot;</span>, <span class="comment">--青蛙雨</span></span><br><span class="line">        wildfires = <span class="string">&quot;default&quot;</span>, <span class="comment">--火灾</span></span><br><span class="line">        touchstone = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        regrowth = <span class="string">&quot;default&quot;</span>,           <span class="comment">-- &quot;veryslow&quot;, &quot;slow&quot;, &quot;default&quot;, &quot;fast&quot;, &quot;veryfast&quot;</span></span><br><span class="line">        cavelight = <span class="string">&quot;default&quot;</span>,          <span class="comment">-- &quot;veryslow&quot;, &quot;slow&quot;, &quot;default&quot;, &quot;fast&quot;, &quot;veryfast&quot;</span></span><br><span class="line">        boons = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        prefabswaps_start = <span class="string">&quot;default&quot;</span>,  <span class="comment">-- &quot;classic&quot;, &quot;default&quot;, &quot;highly random&quot;</span></span><br><span class="line">        prefabswaps = <span class="string">&quot;default&quot;</span>,        <span class="comment">-- &quot;none&quot;, &quot;few&quot;, &quot;default&quot;, &quot;many&quot;, &quot;max&quot;</span></span><br><span class="line">        specialevent = <span class="string">&quot;&quot;</span>,  <span class="comment">-- 特殊节日，一般选填冬季盛宴 winters_feast</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">-- RESOURCES</span></span><br><span class="line">        flowers = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        grass = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        sapling = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        marshbush = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        tumbleweed = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        reeds = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        trees = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        flint = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        rock = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        rock_ice = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        meteorspawner = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        meteorshowers = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        mushtree = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        fern = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        flower_cave = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        wormlights = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">  </span><br><span class="line">        <span class="comment">-- UNPREPARED</span></span><br><span class="line">        berrybush = <span class="string">&quot;default&quot;</span>, <span class="comment">--浆果</span></span><br><span class="line">        carrot = <span class="string">&quot;default&quot;</span>, <span class="comment">--萝卜</span></span><br><span class="line">        mushroom = <span class="string">&quot;default&quot;</span>, <span class="comment">--蘑菇</span></span><br><span class="line">        cactus = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        banana = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        lichen = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">  </span><br><span class="line">        <span class="comment">-- ANIMALS</span></span><br><span class="line">        rabbits = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        moles = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        butterfly = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        birds = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        buzzard = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        catcoon = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        perd = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        pigs = <span class="string">&quot;default&quot;</span>, <span class="comment">--猪</span></span><br><span class="line">        lightninggoat = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        beefalo = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        beefaloheat = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        hunt = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        alternatehunt = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        penguins = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        cave_ponds = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        ponds = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        bees = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        angrybees = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        tallbirds = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        slurper = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        bunnymen = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        slurtles = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        rocky = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        monkey = <span class="string">&quot;default&quot;</span>, <span class="comment">--猴子</span></span><br><span class="line">  </span><br><span class="line">        <span class="comment">-- MONSTERS</span></span><br><span class="line">        spiders = <span class="string">&quot;default&quot;</span>, <span class="comment">--蜘蛛</span></span><br><span class="line">        cave_spiders = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        hounds = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        houndmound = <span class="string">&quot;default&quot;</span>, <span class="comment">--猎犬袭击</span></span><br><span class="line">        merm = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        tentacles = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        chess = <span class="string">&quot;default&quot;</span>, <span class="comment">--地上发条数量</span></span><br><span class="line">        lureplants = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        walrus = <span class="string">&quot;default&quot;</span>, </span><br><span class="line">        liefs = <span class="string">&quot;default&quot;</span>, <span class="comment">--树人频率</span></span><br><span class="line">        deciduousmonster = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        krampus = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        bearger = <span class="string">&quot;default&quot;</span>, <span class="comment">--熊大</span></span><br><span class="line">        deerclops = <span class="string">&quot;default&quot;</span>, <span class="comment">-- 巨鹿</span></span><br><span class="line">        goosemoose = <span class="string">&quot;default&quot;</span>, <span class="comment">-- 蠢鹅</span></span><br><span class="line">        dragonfly = <span class="string">&quot;default&quot;</span>, <span class="comment">--苍蝇</span></span><br><span class="line">        bats = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        fissure = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        worms = <span class="string">&quot;default&quot;</span>, <span class="comment">--蠕虫</span></span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>洞穴：</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">    override_enabled = <span class="literal">true</span>,</span><br><span class="line">    preset = <span class="string">&quot;DST_CAVE&quot;</span>,                 <span class="comment">-- &quot;SURVIVAL_TOGETHER&quot;, &quot;MOD_MISSING&quot;, &quot;SURVIVAL_TOGETHER_CLASSIC&quot;, &quot;SURVIVAL_DEFAULT_PLUS&quot;, &quot;COMPLETE_DARKNESS&quot;, &quot;DST_CAVE&quot;, &quot;DST_CAVE_PLUS&quot;</span></span><br><span class="line">    overrides = &#123;</span><br><span class="line">        <span class="comment">-- defalut is &quot;never&quot;, &quot;rare&quot;, &quot;default&quot;, &quot;often&quot;, &quot;always&quot;</span></span><br><span class="line">  </span><br><span class="line">        <span class="comment">-- MISC</span></span><br><span class="line">        task_set = <span class="string">&quot;cave_default&quot;</span>,       <span class="comment">-- &quot;classic&quot;, &quot;default&quot;, &quot;cave_default&quot;</span></span><br><span class="line">        start_location = <span class="string">&quot;default&quot;</span>,      <span class="comment">-- &quot;caves&quot;, &quot;default&quot;, &quot;plus&quot;, &quot;darkness&quot;</span></span><br><span class="line">        world_size = <span class="string">&quot;default&quot;</span>,          <span class="comment">-- &quot;small&quot;, &quot;medium&quot;, &quot;default&quot;, &quot;huge&quot;</span></span><br><span class="line">        branching = <span class="string">&quot;default&quot;</span>,           <span class="comment">-- &quot;never&quot;, &quot;least&quot;, &quot;default&quot;, &quot;most&quot;</span></span><br><span class="line">        loop = <span class="string">&quot;default&quot;</span>,                <span class="comment">-- &quot;never&quot;, &quot;default&quot;, &quot;always&quot;</span></span><br><span class="line">        autumn = <span class="string">&quot;default&quot;</span>,              <span class="comment">-- &quot;noseason&quot;, &quot;veryshortseason&quot;, &quot;shortseason&quot;, &quot;default&quot;, &quot;longseason&quot;, &quot;verylongseason&quot;, &quot;random&quot;</span></span><br><span class="line">        winter = <span class="string">&quot;default&quot;</span>,              <span class="comment">-- &quot;noseason&quot;, &quot;veryshortseason&quot;, &quot;shortseason&quot;, &quot;default&quot;, &quot;longseason&quot;, &quot;verylongseason&quot;, &quot;random&quot;</span></span><br><span class="line">        spring = <span class="string">&quot;default&quot;</span>,              <span class="comment">-- &quot;noseason&quot;, &quot;veryshortseason&quot;, &quot;shortseason&quot;, &quot;default&quot;, &quot;longseason&quot;, &quot;verylongseason&quot;, &quot;random&quot;</span></span><br><span class="line">        summer = <span class="string">&quot;default&quot;</span>,              <span class="comment">-- &quot;noseason&quot;, &quot;veryshortseason&quot;, &quot;shortseason&quot;, &quot;default&quot;, &quot;longseason&quot;, &quot;verylongseason&quot;, &quot;random&quot;</span></span><br><span class="line">        season_start = <span class="string">&quot;default&quot;</span>,        <span class="comment">-- &quot;default&quot;, &quot;winter&quot;, &quot;spring&quot;, &quot;summer&quot;, &quot;autumnorspring&quot;, &quot;winterorsummer&quot;, &quot;random&quot;</span></span><br><span class="line">        day = <span class="string">&quot;default&quot;</span>,                 <span class="comment">-- &quot;default&quot;, &quot;longday&quot;, &quot;longdusk&quot;, &quot;longnight&quot;, &quot;noday&quot;, &quot;nodusk&quot;, &quot;nonight&quot;, &quot;onlyday&quot;, &quot;onlydusk&quot;, &quot;onlynight&quot;</span></span><br><span class="line">        weather = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        earthquakes = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        lightning = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        frograin = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        wildfires = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        touchstone = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        regrowth = <span class="string">&quot;default&quot;</span>,            <span class="comment">-- &quot;veryslow&quot;, &quot;slow&quot;, &quot;default&quot;, &quot;fast&quot;, &quot;veryfast&quot;</span></span><br><span class="line">        cavelight = <span class="string">&quot;default&quot;</span>,           <span class="comment">-- &quot;veryslow&quot;, &quot;slow&quot;, &quot;default&quot;, &quot;fast&quot;, &quot;veryfast&quot;</span></span><br><span class="line">        boons = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        prefabswaps_start = <span class="string">&quot;default&quot;</span>,   <span class="comment">-- &quot;classic&quot;, &quot;default&quot;, &quot;highly random&quot;</span></span><br><span class="line">        prefabswaps = <span class="string">&quot;default&quot;</span>,         <span class="comment">-- &quot;none&quot;, &quot;few&quot;, &quot;default&quot;, &quot;many&quot;, &quot;max&quot;</span></span><br><span class="line">  </span><br><span class="line">        <span class="comment">-- RESOURCES</span></span><br><span class="line">        flowers = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        grass = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        sapling = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        marshbush = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        tumbleweed = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        reeds = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        trees = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        flint = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        rock = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        rock_ice = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        meteorspawner = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        meteorshowers = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        mushtree = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        fern = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        flower_cave = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        wormlights = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">  </span><br><span class="line">        <span class="comment">-- UNPREPARED</span></span><br><span class="line">        berrybush = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        carrot = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        mushroom = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        cactus = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        banana = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        lichen = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">  </span><br><span class="line">        <span class="comment">-- ANIMALS</span></span><br><span class="line">        rabbits = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        moles = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        butterfly = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        birds = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        buzzard = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        catcoon = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        perd = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        pigs = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        lightninggoat = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        beefalo = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        beefaloheat = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        hunt = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        alternatehunt = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        penguins = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        cave_ponds = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        ponds = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        bees = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        angrybees = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        tallbirds = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        slurper = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        bunnymen = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        slurtles = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        rocky = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        monkey = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">  </span><br><span class="line">        <span class="comment">-- MONSTERS</span></span><br><span class="line">        spiders = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        cave_spiders = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        hounds = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        houndmound = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        merm = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        tentacles = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        chess = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        lureplants = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        walrus = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        liefs = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        deciduousmonster = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        krampus = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        bearger = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        deerclops = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        goosemoose = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        dragonfly = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        bats = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        fissure = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">        worms = <span class="string">&quot;default&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这时基本的已经完成，已经可以正常开服，但是没MOD怎么玩得下去嘞～<br>下面6，7，8为可选配置：</p><h4 id="6-配置下载mod文件"><a href="#6-配置下载mod文件" class="headerlink" title="6. 配置下载mod文件"></a>6. 配置下载mod文件</h4> <div class="note info flat"><p>创建dedicated_server_mods_setup.lua文件：</p></div><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">--第一种是安装单独mod</span></span><br><span class="line">  <span class="comment">--ServerModSetup(&quot;mod的id&quot;)</span></span><br><span class="line">  <span class="comment">--第二种是安装mod合集</span></span><br><span class="line">  <span class="comment">--ServerModCollectionSetup(&quot;合集的id&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--下面推荐几个常用的mod   </span></span><br><span class="line">ServerModSetup(<span class="string">&quot;666155465&quot;</span>) <span class="comment">--show me</span></span><br><span class="line">ServerModSetup(<span class="string">&quot;375859599&quot;</span>) <span class="comment">--health info</span></span><br><span class="line">ServerModSetup(<span class="string">&quot;780009141&quot;</span>) <span class="comment">--物品箱子提示</span></span><br><span class="line">ServerModSetup(<span class="string">&quot;462434129&quot;</span>) <span class="comment">--restart</span></span><br><span class="line">ServerModSetup(<span class="string">&quot;367546858&quot;</span>) <span class="comment">--服务端中文</span></span><br><span class="line">ServerModSetup(<span class="string">&quot;841471368&quot;</span>) <span class="comment">--防熊锁</span></span><br><span class="line">ServerModSetup(<span class="string">&quot;378160973&quot;</span>) <span class="comment">--全图定位</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">--饥荒的mod id查看：浏览器打开创意工坊任意要下载的mod页面，url处会有id=xxxxxxxx</span></span><br></pre></td></tr></table></figure><p>保存在~/dst/mods/ 目录下，第一次开服时服务器会自动下载mod。</p><h4 id="7-配置地上和洞穴的mod开关文件"><a href="#7-配置地上和洞穴的mod开关文件" class="headerlink" title="7. 配置地上和洞穴的mod开关文件"></a>7. 配置地上和洞穴的mod开关文件</h4><div class="note info flat"><p>MOD开关文件：modoverrides.lua</p></div><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">[<span class="string">&quot;workshop-375859599&quot;</span>] = &#123; enabled = <span class="literal">true</span> &#125;,<span class="comment">--healh info</span></span><br><span class="line">[<span class="string">&quot;workshop-841471368&quot;</span>] = &#123; enabled = <span class="literal">true</span> &#125;,<span class="comment">--fangxiongsuo</span></span><br><span class="line">[<span class="string">&quot;workshop-378160973&quot;</span>] = &#123; enabled = <span class="literal">true</span> &#125;,<span class="comment">--Global Positions</span></span><br><span class="line">[<span class="string">&quot;workshop-462434129&quot;</span>] = &#123; enabled = <span class="literal">true</span> &#125;,<span class="comment">--restart</span></span><br><span class="line">[<span class="string">&quot;workshop-780009141&quot;</span>] = &#123; enabled = <span class="literal">true</span> &#125;,<span class="comment">--Finder</span></span><br><span class="line">[<span class="string">&quot;workshop-666155465&quot;</span>] = &#123; enabled = <span class="literal">true</span> &#125;,<span class="comment">--Show Me</span></span><br><span class="line">[<span class="string">&quot;workshop-367546858&quot;</span>] = &#123;enabled = <span class="literal">true</span>&#125; <span class="comment">--chinese</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">--true表示启用，false表示禁用</span></span><br></pre></td></tr></table></figure><p>Master和Caves 文件夹里各放一份。</p><h5 id="8-配置管理员，黑名单等"><a href="#8-配置管理员，黑名单等" class="headerlink" title="8. 配置管理员，黑名单等"></a>8. 配置管理员，黑名单等</h5><blockquote><p>创建adminlist.txt文件，填入用户id（KU_开头的），用户id可以在人员进入服务器后Master目录下的chat log文件里找到。</p></blockquote><blockquote><p>黑白名单同理，分别创建blocklist.txt和whitelist.txt</p></blockquote><h4 id="最后你的服务器目录应该是这样："><a href="#最后你的服务器目录应该是这样：" class="headerlink" title="最后你的服务器目录应该是这样："></a>最后你的服务器目录应该是这样：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;home&#x2F;ubuntu&#x2F;.klei&#x2F;DoNotStarveTogether&#x2F;MyDediServer</span><br><span class="line">|</span><br><span class="line">|   adminlist.txt（&#x2F;adminlist.txt）</span><br><span class="line">|   blocklist.txt（&#x2F;blocklist.txt）</span><br><span class="line">|   cluster.ini（&#x2F;cluster.ini）</span><br><span class="line">|   cluster_token.txt（&#x2F;cluster_token.txt）</span><br><span class="line">|   whitelist.txt（&#x2F;whitelist.txt）</span><br><span class="line">|</span><br><span class="line">|---Master</span><br><span class="line">|   |   modoverrides.lua（&#x2F;Master&#x2F;modoverrides.lua）</span><br><span class="line">|   |   server.ini（&#x2F;Master&#x2F;server.ini）</span><br><span class="line">|   |   worldgenoverride.lua（&#x2F;Master&#x2F;worldgenoverride.lua）</span><br><span class="line">|   </span><br><span class="line">|   </span><br><span class="line">|  </span><br><span class="line">|</span><br><span class="line">|---Caves</span><br><span class="line">    |   modoverrides.lua（&#x2F;Caves&#x2F;modoverrides.lua）</span><br><span class="line">    |   server.ini（&#x2F;Caves&#x2F;server.ini）</span><br><span class="line">    |   worldgenoverride.lua（&#x2F;Caves&#x2F;worldgenoverride.lua）</span><br><span class="line">   </span><br><span class="line"> </span><br><span class="line">&#x2F;home&#x2F;ubuntu&#x2F;dst&#x2F;mods</span><br><span class="line">|</span><br><span class="line">|   dedicated_server_mods_setup.lua（&#x2F;dedicated_server_mods_setup.lua）</span><br></pre></td></tr></table></figure><div class="note info flat"><p>最后一步：开服！</p></div><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#启动地上</span></span><br><span class="line"><span class="built_in">cd</span> ~/dst/bin</span><br><span class="line">screen sh ./overworld.sh  </span><br><span class="line">再按下Ctrl+A键,然后按C键创建另一个会话</span><br><span class="line"><span class="comment">#启动地下</span></span><br><span class="line"><span class="built_in">cd</span> ~/dst/bin </span><br><span class="line">screen sh ./cave.sh</span><br></pre></td></tr></table></figure><blockquote><p>注：饥荒版本更新时，服务器版本更新命令（先关闭游戏进程）：</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/steamcmd/steamcmd.sh +login anonymous +force_install_dir ~/dst +app_update 343050 validate +quit</span><br></pre></td></tr></table></figure><hr><h4 id="———简单开服-amp-管理———"><a href="#———简单开服-amp-管理———" class="headerlink" title="———简单开服&amp;管理———-"></a>———简单开服&amp;管理———-</h4><p>其实这些命令都可以简化连续成自动化脚本来使用，，<br>于是我写了个综合示例 <a href="https://github.com/qwertyuiop6/DST-Server-Build">DST server build</a><br>里面的go.sh和dst.sh即为开服脚本和管理脚本，详解–&gt; <a href="/2017/11/20/dst-shell/">使用简单shell脚本管理DST服务器</a></p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
          <category> Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Game </tag>
            
            <tag> Linux </tag>
            
            <tag> lua </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
